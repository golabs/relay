<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RELAY - Neon Cyberpunk Command Center</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        /* =============================================
           NEON CYBERPUNK COMMAND CENTER
           ============================================= */
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

        :root {
            --bg-deep: #050a12;
            --bg-panel: #0a1020;
            --bg-panel-alt: #0c1428;
            --bg-input: #0e1630;
            --bg-header: #080e1c;
            --text: #d0e0f0;
            --text-dim: #5a7090;
            --text-bright: #e8f0ff;
            --cyan: #00f0ff;
            --cyan-dim: #007a82;
            --cyan-glow: rgba(0, 240, 255, 0.3);
            --magenta: #ff00aa;
            --magenta-dim: #80005a;
            --magenta-glow: rgba(255, 0, 170, 0.3);
            --green: #00ff88;
            --green-dim: #007744;
            --green-glow: rgba(0, 255, 136, 0.3);
            --yellow: #ffe600;
            --border: #1a2a40;
            --border-glow: #0d3050;
        }

        html, body {
            height: 100%;
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--bg-deep);
            color: var(--text);
            overflow: hidden;
        }

        /* === CUSTOM SCROLLBARS === */
        ::-webkit-scrollbar { width: 5px; height: 5px; }
        ::-webkit-scrollbar-track { background: rgba(0, 240, 255, 0.03); }
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--cyan-dim), var(--magenta-dim));
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, var(--cyan), var(--magenta));
        }
        * { scrollbar-width: thin; scrollbar-color: var(--cyan-dim) rgba(0,240,255,0.03); }

        /* === ANIMATED SVG BACKGROUND === */
        .svg-bg {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            z-index: 0;
            pointer-events: none;
            opacity: 0.15;
        }
        .hex-cell {
            fill: none;
            stroke: var(--cyan);
            stroke-width: 0.5;
            opacity: 0;
            animation: hexFade 8s ease-in-out infinite;
        }
        .hex-cell:nth-child(3n) { stroke: var(--magenta); animation-delay: 1s; }
        .hex-cell:nth-child(5n) { stroke: var(--green); animation-delay: 2.5s; }
        .hex-cell:nth-child(7n) { animation-delay: 4s; }
        .hex-cell:nth-child(11n) { animation-delay: 5.5s; }
        @keyframes hexFade {
            0%, 100% { opacity: 0; stroke-width: 0.3; }
            30% { opacity: 0.6; stroke-width: 0.8; }
            60% { opacity: 0.2; }
        }

        .circuit-line {
            stroke: var(--cyan);
            stroke-width: 0.8;
            fill: none;
            stroke-dasharray: 200;
            stroke-dashoffset: 200;
            opacity: 0.3;
            animation: circuitDraw 6s linear infinite;
        }
        .circuit-line:nth-child(2n) { stroke: var(--magenta); animation-delay: 2s; animation-duration: 8s; }
        .circuit-line:nth-child(3n) { stroke: var(--green); animation-delay: 4s; animation-duration: 10s; }
        @keyframes circuitDraw {
            0% { stroke-dashoffset: 200; opacity: 0; }
            10% { opacity: 0.5; }
            50% { stroke-dashoffset: 0; opacity: 0.3; }
            90% { opacity: 0.5; }
            100% { stroke-dashoffset: -200; opacity: 0; }
        }

        .data-particle {
            fill: var(--cyan);
            opacity: 0;
            animation: particleFloat 12s linear infinite;
        }
        .data-particle:nth-child(2n) { fill: var(--magenta); animation-delay: 3s; }
        .data-particle:nth-child(3n) { fill: var(--green); animation-delay: 6s; }
        .data-particle:nth-child(5n) { animation-delay: 9s; }
        @keyframes particleFloat {
            0% { opacity: 0; transform: translateY(0) translateX(0); }
            10% { opacity: 0.8; }
            90% { opacity: 0.8; }
            100% { opacity: 0; transform: translateY(-300px) translateX(50px); }
        }

        /* === SCANLINE EFFECT === */
        .scanline-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            z-index: 9999;
            pointer-events: none;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(0, 0, 0, 0.03) 2px,
                rgba(0, 0, 0, 0.03) 4px
            );
        }

        /* === APP CONTAINER === */
        .app {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* === HEADER - SPACESHIP CONTROL BAR === */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 16px;
            height: 52px;
            background: linear-gradient(180deg, var(--bg-header) 0%, rgba(8,14,28,0.95) 100%);
            border-bottom: 1px solid var(--border);
            position: relative;
            z-index: 10;
        }
        .header::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0; right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--cyan), var(--magenta), var(--cyan), transparent);
            animation: headerLine 4s linear infinite;
        }
        @keyframes headerLine {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        .header-title {
            font-size: 20px;
            font-weight: 900;
            letter-spacing: 6px;
            text-transform: uppercase;
            color: var(--cyan);
            text-shadow: 0 0 10px var(--cyan-glow), 0 0 30px rgba(0,240,255,0.15);
            position: relative;
        }
        .header-title::before {
            content: '';
            position: absolute;
            left: -12px;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 20px;
            background: var(--cyan);
            box-shadow: 0 0 8px var(--cyan-glow);
        }

        /* Workflow / Tactical Buttons */
        .header-center { display: flex; gap: 6px; align-items: center; }
        .workflow-btn {
            padding: 6px 16px;
            border: 1px solid var(--border);
            background: var(--bg-input);
            color: var(--text);
            cursor: pointer;
            font-family: 'Inter', sans-serif;
            font-size: 12px;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
            transition: all 0.25s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            clip-path: polygon(8px 0, 100% 0, calc(100% - 8px) 100%, 0 100%);
            position: relative;
        }
        .workflow-btn:hover {
            background: rgba(0, 240, 255, 0.15);
            border-color: var(--cyan);
            color: var(--cyan);
            box-shadow: 0 0 15px var(--cyan-glow), inset 0 0 15px rgba(0,240,255,0.05);
            text-shadow: 0 0 8px var(--cyan-glow);
        }
        .workflow-btn:active {
            transform: scale(0.97);
        }
        .step-num {
            background: rgba(0,240,255,0.15);
            color: var(--cyan);
            padding: 2px 7px;
            font-size: 10px;
            font-weight: 800;
            clip-path: polygon(3px 0, 100% 0, calc(100% - 3px) 100%, 0 100%);
        }

        /* Header Controls */
        .header-controls { display: flex; gap: 8px; align-items: center; }

        .health-indicator {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 4px 12px;
            border-radius: 2px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid transparent;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        .health-indicator:hover { border-color: var(--green-dim); background: rgba(0,255,136,0.05); }
        .health-dot {
            width: 8px; height: 8px;
            border-radius: 50%;
            background: var(--green);
            box-shadow: 0 0 8px var(--green-glow), 0 0 20px rgba(0,255,136,0.15);
            animation: healthPulse 2s ease-in-out infinite;
        }
        @keyframes healthPulse {
            0%, 100% { box-shadow: 0 0 4px var(--green-glow); }
            50% { box-shadow: 0 0 12px var(--green-glow), 0 0 24px rgba(0,255,136,0.2); }
        }
        .health-text { color: var(--green); font-weight: 600; }

        .project-select {
            padding: 6px 10px;
            border: 1px solid var(--border);
            background: var(--bg-input);
            color: var(--text);
            font-family: 'Inter', sans-serif;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 130px;
            clip-path: polygon(4px 0, 100% 0, calc(100% - 4px) 100%, 0 100%);
            letter-spacing: 0.5px;
        }
        .project-select:hover { border-color: var(--cyan); }
        .project-select:focus { outline: none; border-color: var(--cyan); box-shadow: 0 0 8px var(--cyan-glow); }

        /* Icon Buttons */
        .icon-btn {
            width: 34px; height: 34px;
            padding: 0;
            border: 1px solid var(--border);
            background: var(--bg-input);
            color: var(--text-dim);
            cursor: pointer;
            font-size: 14px;
            transition: all 0.25s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            clip-path: polygon(4px 0, 100% 0, calc(100% - 4px) 100%, 0 100%);
        }
        .icon-btn:hover {
            color: var(--cyan);
            border-color: var(--cyan);
            background: rgba(0,240,255,0.1);
            box-shadow: 0 0 12px var(--cyan-glow);
            text-shadow: 0 0 8px var(--cyan-glow);
        }
        .icon-btn.primary {
            background: linear-gradient(135deg, rgba(0,240,255,0.3), rgba(0,240,255,0.1));
            border-color: var(--cyan);
            color: var(--cyan);
            box-shadow: 0 0 8px var(--cyan-glow);
        }
        .icon-btn.primary:hover {
            background: linear-gradient(135deg, rgba(0,240,255,0.5), rgba(0,240,255,0.2));
            box-shadow: 0 0 20px var(--cyan-glow);
        }
        .icon-btn.danger { border-color: var(--magenta-dim); color: var(--magenta); }
        .icon-btn.danger:hover {
            background: rgba(255,0,170,0.15);
            box-shadow: 0 0 12px var(--magenta-glow);
        }

        /* === MAIN LAYOUT === */
        .main {
            display: flex;
            flex: 1;
            overflow: hidden;
            gap: 1px;
            background: var(--border);
        }

        /* === PANEL STYLING (shared) === */
        .panel {
            display: flex;
            flex-direction: column;
            background: var(--bg-panel);
            position: relative;
            overflow: hidden;
        }
        .panel::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            border: 1px solid transparent;
            pointer-events: none;
            z-index: 2;
            transition: border-color 0.3s;
        }
        .panel:hover::before {
            border-color: rgba(0, 240, 255, 0.15);
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 14px;
            background: linear-gradient(180deg, rgba(10,16,32,0.9), var(--bg-panel));
            border-bottom: 1px solid var(--border);
            position: relative;
            z-index: 3;
        }
        .panel-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0; right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--cyan-dim), transparent);
        }
        .panel-title {
            font-weight: 700;
            font-size: 13px;
            letter-spacing: 2px;
            text-transform: uppercase;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .panel-controls { display: flex; gap: 6px; align-items: center; }

        .panel-content {
            flex: 1;
            overflow-y: auto;
            padding: 14px;
            position: relative;
        }

        /* === HISTORY SIDEBAR === */
        .history-sidebar {
            width: 240px;
            min-width: 240px;
        }
        .history-sidebar .panel-title { color: var(--text-dim); }
        .history-sidebar .panel-header::after {
            background: linear-gradient(90deg, transparent, var(--text-dim), transparent);
        }

        .history-list {
            flex: 1;
            overflow-y: auto;
            padding: 8px;
        }
        .history-item {
            padding: 10px 12px;
            margin-bottom: 6px;
            background: rgba(10, 20, 40, 0.6);
            border: 1px solid var(--border);
            border-left: 3px solid var(--cyan-dim);
            cursor: pointer;
            transition: all 0.2s;
            clip-path: polygon(0 0, calc(100% - 6px) 0, 100% 6px, 100% 100%, 6px 100%, 0 calc(100% - 6px));
        }
        .history-item:hover {
            border-color: var(--cyan);
            border-left-color: var(--cyan);
            background: rgba(0, 240, 255, 0.05);
            box-shadow: inset 0 0 20px rgba(0,240,255,0.03);
        }
        .history-item.active {
            border-color: var(--cyan);
            border-left-color: var(--cyan);
            background: rgba(0, 240, 255, 0.08);
        }
        .history-time {
            font-size: 10px;
            color: var(--text-dim);
            letter-spacing: 0.5px;
            text-transform: uppercase;
            margin-bottom: 4px;
        }
        .history-preview {
            font-size: 12px;
            color: var(--text);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .history-count {
            padding: 8px 12px;
            font-size: 10px;
            color: var(--text-dim);
            letter-spacing: 1px;
            text-transform: uppercase;
            border-top: 1px solid var(--border);
        }

        /* === AXION PANEL (CENTER) === */
        .axion-panel { flex: 1.3; }
        .axion-panel .panel-title { color: var(--cyan); text-shadow: 0 0 8px var(--cyan-glow); }
        .axion-panel .panel-header::after {
            background: linear-gradient(90deg, transparent, var(--cyan), transparent);
        }

        /* LIVE Activity Box */
        .live-box {
            background: linear-gradient(135deg, rgba(0,240,255,0.06), rgba(0,255,136,0.03));
            border: 1px solid var(--cyan-dim);
            margin-bottom: 16px;
            position: relative;
            overflow: hidden;
            clip-path: polygon(0 0, calc(100% - 12px) 0, 100% 12px, 100% 100%, 12px 100%, 0 calc(100% - 12px));
        }
        /* Animated border glow */
        .live-box::before {
            content: '';
            position: absolute;
            top: -1px; left: -1px; right: -1px; bottom: -1px;
            background: linear-gradient(90deg, transparent, var(--cyan), var(--magenta), transparent);
            background-size: 300% 100%;
            animation: borderShift 3s linear infinite;
            z-index: 0;
            opacity: 0.3;
            clip-path: polygon(0 0, calc(100% - 12px) 0, 100% 12px, 100% 100%, 12px 100%, 0 calc(100% - 12px));
        }
        @keyframes borderShift {
            0% { background-position: 0% 0; }
            100% { background-position: 300% 0; }
        }
        .live-box-inner {
            position: relative;
            z-index: 1;
            background: linear-gradient(135deg, rgba(5,10,18,0.95), rgba(10,16,32,0.95));
        }

        .live-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: rgba(0, 240, 255, 0.05);
            border-bottom: 1px solid rgba(0,240,255,0.1);
        }
        .live-indicator {
            display: flex;
            align-items: center;
            gap: 6px;
            font-weight: 700;
            font-size: 11px;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        .live-dot {
            width: 8px; height: 8px;
            border-radius: 50%;
            background: var(--green);
            box-shadow: 0 0 6px var(--green-glow);
            animation: livePulse 1s ease-in-out infinite;
        }
        @keyframes livePulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.4; transform: scale(0.85); }
        }
        .live-label { color: var(--green); }
        .live-status { font-size: 11px; color: var(--text-dim); letter-spacing: 0.5px; }

        .live-content {
            padding: 12px;
            font-size: 13px;
            line-height: 1.5;
            color: var(--text);
            min-height: 30px;
        }

        /* Radar sweep / scanning line effect */
        .live-scan {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            pointer-events: none;
            z-index: 2;
            overflow: hidden;
        }
        .live-scan::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 60%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0,240,255,0.08), transparent);
            animation: scanLine 3s ease-in-out infinite;
        }
        @keyframes scanLine {
            0% { left: -60%; }
            100% { left: 120%; }
        }

        /* Voice Visualizer Bars */
        .voice-visualizer {
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 3px;
            padding: 8px 12px 12px;
            height: 44px;
        }
        .v-bar {
            width: 4px;
            border-radius: 2px;
            background: linear-gradient(0deg, var(--cyan), var(--magenta));
            box-shadow: 0 0 6px var(--cyan-glow);
            animation: vBarPulse 1s ease-in-out infinite;
        }
        .v-bar:nth-child(1) { height: 10px; animation-delay: 0s; animation-duration: 0.8s; }
        .v-bar:nth-child(2) { height: 18px; animation-delay: 0.1s; animation-duration: 0.7s; }
        .v-bar:nth-child(3) { height: 24px; animation-delay: 0.15s; animation-duration: 0.9s; }
        .v-bar:nth-child(4) { height: 14px; animation-delay: 0.05s; animation-duration: 0.65s; }
        .v-bar:nth-child(5) { height: 20px; animation-delay: 0.2s; animation-duration: 0.85s; }
        .v-bar:nth-child(6) { height: 28px; animation-delay: 0.08s; animation-duration: 0.75s; }
        .v-bar:nth-child(7) { height: 12px; animation-delay: 0.18s; animation-duration: 0.95s; }
        @keyframes vBarPulse {
            0%, 100% { transform: scaleY(0.4); opacity: 0.5; }
            50% { transform: scaleY(1); opacity: 1; }
        }

        /* Response Messages */
        .response-area { flex-shrink: 0; }
        .msg-entry {
            margin-bottom: 16px;
            padding-bottom: 16px;
            border-bottom: 1px solid rgba(26, 42, 64, 0.6);
        }
        .msg-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        .msg-time {
            font-size: 10px;
            color: var(--text-dim);
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        .msg-user {
            color: var(--cyan);
            margin-bottom: 8px;
            padding: 8px 12px;
            background: rgba(0,240,255,0.06);
            border-left: 3px solid var(--cyan);
            font-size: 13px;
            letter-spacing: 0.3px;
        }
        .msg-assistant {
            font-size: 13px;
            line-height: 1.6;
            color: var(--text);
        }
        .msg-assistant code {
            background: rgba(0,240,255,0.08);
            border: 1px solid rgba(0,240,255,0.15);
            padding: 1px 6px;
            border-radius: 3px;
            font-family: 'Inter', monospace;
            font-size: 12px;
            color: var(--cyan);
        }
        .msg-assistant pre {
            background: rgba(5, 10, 20, 0.8);
            border: 1px solid var(--border);
            padding: 12px;
            margin: 8px 0;
            overflow-x: auto;
            font-size: 12px;
            line-height: 1.5;
            border-left: 3px solid var(--magenta-dim);
            color: var(--text);
            font-family: 'Inter', monospace;
        }
        .msg-assistant h3 {
            color: var(--cyan);
            font-size: 14px;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin: 12px 0 6px;
            text-shadow: 0 0 6px var(--cyan-glow);
        }
        .msg-assistant ul {
            margin-left: 16px;
            margin-bottom: 8px;
        }
        .msg-assistant li {
            margin-bottom: 4px;
            position: relative;
        }
        .msg-assistant li::marker {
            color: var(--cyan);
        }

        /* === BRETT PANEL (RIGHT) === */
        .brett-panel { flex: 0.9; }
        .brett-panel .panel-title { color: var(--magenta); text-shadow: 0 0 8px var(--magenta-glow); }
        .brett-panel .panel-header::after {
            background: linear-gradient(90deg, transparent, var(--magenta), transparent);
        }
        .brett-panel .panel-content { padding: 0; display: flex; flex-direction: column; }

        .input-wrapper {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        .line-numbers {
            width: 40px;
            min-width: 40px;
            padding: 12px 6px 12px 4px;
            text-align: right;
            color: var(--text-dim);
            font-size: 12px;
            line-height: 1.7;
            font-family: 'Inter', monospace;
            user-select: none;
            border-right: 1px solid var(--border);
            background: rgba(0,0,0,0.2);
            overflow: hidden;
        }
        .input-area {
            flex: 1;
            width: 100%;
            height: 100%;
            background: transparent;
            border: none;
            color: var(--text-bright);
            font-size: 13px;
            line-height: 1.7;
            resize: none;
            outline: none;
            font-family: 'Inter', sans-serif;
            padding: 12px;
            caret-color: var(--magenta);
        }
        .input-area::placeholder { color: var(--text-dim); }
        .input-area:focus { background: rgba(255,0,170,0.02); }

        .image-preview-area {
            padding: 8px 14px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        .img-thumb {
            width: 60px; height: 40px;
            border: 1px solid var(--border);
            border-radius: 3px;
            object-fit: cover;
            opacity: 0.7;
            transition: opacity 0.2s;
        }
        .img-thumb:hover { opacity: 1; border-color: var(--magenta); }

        /* === MESSAGE QUEUE === */
        .queue-panel {
            padding: 6px 16px;
            background: linear-gradient(180deg, rgba(255,0,170,0.05), transparent);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .queue-title {
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 1px;
            text-transform: uppercase;
            color: var(--magenta);
        }
        .queue-items { display: flex; gap: 8px; flex: 1; overflow-x: auto; }
        .queue-chip {
            padding: 4px 12px;
            background: rgba(255,0,170,0.08);
            border: 1px solid var(--magenta-dim);
            font-size: 11px;
            color: var(--text);
            white-space: nowrap;
            clip-path: polygon(4px 0, 100% 0, calc(100% - 4px) 100%, 0 100%);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .queue-num {
            width: 16px; height: 16px;
            border-radius: 50%;
            background: var(--magenta-dim);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 9px;
            font-weight: 800;
            color: var(--text-bright);
        }
        .queue-chip.active {
            border-color: var(--cyan);
            background: rgba(0,240,255,0.08);
        }
        .queue-chip.active .queue-num {
            background: var(--cyan);
            color: var(--bg-deep);
        }
        .queue-clear {
            padding: 3px 10px;
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-dim);
            font-family: 'Inter', sans-serif;
            font-size: 10px;
            cursor: pointer;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            transition: all 0.2s;
        }
        .queue-clear:hover { border-color: var(--magenta); color: var(--magenta); }

        /* === KEYBOARD SHORTCUTS === */
        .shortcuts-bar {
            position: fixed;
            bottom: 0; left: 0; right: 0;
            padding: 6px 16px;
            background: rgba(5, 10, 18, 0.95);
            border-top: 1px solid var(--border);
            font-size: 10px;
            color: var(--text-dim);
            display: flex;
            justify-content: flex-end;
            gap: 16px;
            z-index: 10;
            letter-spacing: 0.5px;
        }
        .shortcuts-bar kbd {
            background: var(--bg-input);
            border: 1px solid var(--border);
            padding: 1px 5px;
            border-radius: 2px;
            font-family: 'Inter', monospace;
            font-size: 10px;
            color: var(--text);
        }

        /* === ACK BANNER === */
        .ack-banner {
            padding: 6px 16px;
            background: rgba(0,240,255,0.05);
            border-bottom: 1px solid var(--cyan-dim);
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--cyan);
            letter-spacing: 0.5px;
        }
        .ack-dot {
            width: 6px; height: 6px;
            border-radius: 50%;
            background: var(--cyan);
            animation: livePulse 1s ease-in-out infinite;
        }

        /* === CORNER ACCENTS ON PANELS === */
        .corner-accent {
            position: absolute;
            width: 20px; height: 20px;
            z-index: 5;
            pointer-events: none;
        }
        .corner-accent.tl { top: 0; left: 0; border-top: 2px solid var(--cyan-dim); border-left: 2px solid var(--cyan-dim); }
        .corner-accent.tr { top: 0; right: 0; border-top: 2px solid var(--cyan-dim); border-right: 2px solid var(--cyan-dim); }
        .corner-accent.bl { bottom: 0; left: 0; border-bottom: 2px solid var(--cyan-dim); border-left: 2px solid var(--cyan-dim); }
        .corner-accent.br { bottom: 0; right: 0; border-bottom: 2px solid var(--cyan-dim); border-right: 2px solid var(--cyan-dim); }

        .brett-panel .corner-accent.tl,
        .brett-panel .corner-accent.bl { border-color: var(--magenta-dim); }
        .brett-panel .corner-accent.tr,
        .brett-panel .corner-accent.br { border-color: var(--magenta-dim); }

        /* === GLITCH TEXT EFFECT ON HOVER (Title) === */
        .header-title:hover {
            animation: glitch 0.3s ease;
        }
        @keyframes glitch {
            0% { transform: translate(0); }
            20% { transform: translate(-2px, 1px); text-shadow: 2px 0 var(--magenta), -2px 0 var(--cyan); }
            40% { transform: translate(1px, -1px); text-shadow: -2px 0 var(--magenta), 2px 0 var(--cyan); }
            60% { transform: translate(-1px, 2px); }
            80% { transform: translate(2px, -1px); text-shadow: 1px 0 var(--green), -1px 0 var(--magenta); }
            100% { transform: translate(0); text-shadow: 0 0 10px var(--cyan-glow), 0 0 30px rgba(0,240,255,0.15); }
        }

        /* === PANEL GLOW HOVER BORDER ANIMATION === */
        @keyframes panelBorderGlow {
            0%, 100% { border-color: rgba(0,240,255,0.1); }
            50% { border-color: rgba(0,240,255,0.3); }
        }

        /* === BRETT SEND BUTTON SPECIAL === */
        .send-btn {
            background: linear-gradient(135deg, var(--cyan), rgba(0,200,220,0.8)) !important;
            border-color: var(--cyan) !important;
            color: var(--bg-deep) !important;
            font-weight: 800 !important;
            box-shadow: 0 0 12px var(--cyan-glow), 0 0 30px rgba(0,240,255,0.1) !important;
        }
        .send-btn:hover {
            box-shadow: 0 0 20px var(--cyan-glow), 0 0 40px rgba(0,240,255,0.2) !important;
            transform: scale(1.05);
        }
    </style>
</head>
<body>

<!-- Animated SVG Background -->
<svg class="svg-bg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1280 720" preserveAspectRatio="xMidYMid slice">
    <defs>
        <filter id="glow">
            <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
            <feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge>
        </filter>
    </defs>
    <!-- Hexagonal Grid -->
    <g filter="url(#glow)">
        <polygon class="hex-cell" points="100,30 130,15 160,30 160,60 130,75 100,60" style="animation-delay:0s"/>
        <polygon class="hex-cell" points="160,30 190,15 220,30 220,60 190,75 160,60" style="animation-delay:1.2s"/>
        <polygon class="hex-cell" points="220,30 250,15 280,30 280,60 250,75 220,60" style="animation-delay:2.4s"/>
        <polygon class="hex-cell" points="130,75 160,60 190,75 190,105 160,120 130,105" style="animation-delay:0.8s"/>
        <polygon class="hex-cell" points="190,75 220,60 250,75 250,105 220,120 190,105" style="animation-delay:3.1s"/>
        <polygon class="hex-cell" points="250,75 280,60 310,75 310,105 280,120 250,105" style="animation-delay:1.5s"/>
        <polygon class="hex-cell" points="700,100 730,85 760,100 760,130 730,145 700,130" style="animation-delay:2s"/>
        <polygon class="hex-cell" points="760,100 790,85 820,100 820,130 790,145 760,130" style="animation-delay:0.5s"/>
        <polygon class="hex-cell" points="820,100 850,85 880,100 880,130 850,145 820,130" style="animation-delay:3.5s"/>
        <polygon class="hex-cell" points="730,145 760,130 790,145 790,175 760,190 730,175" style="animation-delay:4.2s"/>
        <polygon class="hex-cell" points="500,400 530,385 560,400 560,430 530,445 500,430" style="animation-delay:1.8s"/>
        <polygon class="hex-cell" points="560,400 590,385 620,400 620,430 590,445 560,430" style="animation-delay:5s"/>
        <polygon class="hex-cell" points="900,300 930,285 960,300 960,330 930,345 900,330" style="animation-delay:2.7s"/>
        <polygon class="hex-cell" points="960,300 990,285 1020,300 1020,330 990,345 960,330" style="animation-delay:6s"/>
        <polygon class="hex-cell" points="1020,300 1050,285 1080,300 1080,330 1050,345 1020,330" style="animation-delay:3.8s"/>
        <polygon class="hex-cell" points="200,500 230,485 260,500 260,530 230,545 200,530" style="animation-delay:4.5s"/>
        <polygon class="hex-cell" points="260,500 290,485 320,500 320,530 290,545 260,530" style="animation-delay:7s"/>
        <polygon class="hex-cell" points="1100,500 1130,485 1160,500 1160,530 1130,545 1100,530" style="animation-delay:2.2s"/>
        <polygon class="hex-cell" points="1160,500 1190,485 1220,500 1220,530 1190,545 1160,530" style="animation-delay:5.5s"/>
        <polygon class="hex-cell" points="400,200 430,185 460,200 460,230 430,245 400,230" style="animation-delay:0.3s"/>
        <polygon class="hex-cell" points="460,200 490,185 520,200 520,230 490,245 460,230" style="animation-delay:6.5s"/>
        <polygon class="hex-cell" points="650,550 680,535 710,550 710,580 680,595 650,580" style="animation-delay:1.1s"/>
        <polygon class="hex-cell" points="710,550 740,535 770,550 770,580 740,595 710,580" style="animation-delay:3.3s"/>
        <polygon class="hex-cell" points="50,350 80,335 110,350 110,380 80,395 50,380" style="animation-delay:4.8s"/>
        <polygon class="hex-cell" points="1050,150 1080,135 1110,150 1110,180 1080,195 1050,180" style="animation-delay:7.5s"/>
    </g>
    <!-- Circuit Traces -->
    <g filter="url(#glow)">
        <polyline class="circuit-line" points="0,200 80,200 120,170 200,170 240,200 320,200 360,230 440,230"/>
        <polyline class="circuit-line" points="800,600 880,600 920,570 1000,570 1040,600 1120,600 1160,630 1280,630"/>
        <polyline class="circuit-line" points="640,0 640,80 670,120 670,200 640,240 640,320 670,360 670,440"/>
        <polyline class="circuit-line" points="0,500 100,500 140,470 220,470 260,500 380,500"/>
        <polyline class="circuit-line" points="1000,0 1000,60 1030,100 1030,180 1000,220 1000,280"/>
        <polyline class="circuit-line" points="300,720 300,640 330,600 330,520 300,480 300,400"/>
    </g>
    <!-- Data Particles -->
    <g>
        <circle class="data-particle" cx="150" cy="600" r="2" style="animation-delay:0s"/>
        <circle class="data-particle" cx="350" cy="650" r="1.5" style="animation-delay:2s"/>
        <circle class="data-particle" cx="550" cy="700" r="2" style="animation-delay:4s"/>
        <circle class="data-particle" cx="750" cy="680" r="1.5" style="animation-delay:6s"/>
        <circle class="data-particle" cx="950" cy="710" r="2" style="animation-delay:8s"/>
        <circle class="data-particle" cx="1150" cy="660" r="1.5" style="animation-delay:10s"/>
        <circle class="data-particle" cx="250" cy="720" r="1" style="animation-delay:1s"/>
        <circle class="data-particle" cx="450" cy="690" r="1" style="animation-delay:3s"/>
        <circle class="data-particle" cx="850" cy="710" r="1.5" style="animation-delay:5s"/>
        <circle class="data-particle" cx="1050" cy="700" r="1" style="animation-delay:7s"/>
        <circle class="data-particle" cx="80" cy="500" r="1.5" style="animation-delay:9s"/>
        <circle class="data-particle" cx="1200" cy="400" r="2" style="animation-delay:11s"/>
    </g>
</svg>

<!-- Scanline Overlay -->
<div class="scanline-overlay"></div>

<!-- App -->
<div class="app">

    <!-- Header -->
    <header class="header">
        <div class="header-title">RELAY</div>
        <div class="header-center">
            <button class="workflow-btn">
                <span class="step-num">01</span> Review Task
            </button>
            <button class="workflow-btn">
                <span class="step-num">02</span> Explain
            </button>
            <button class="workflow-btn">
                <span class="step-num">03</span> Implement
            </button>
        </div>
        <div class="header-controls">
            <div class="health-indicator">
                <div class="health-dot"></div>
                <span class="health-text">CONNECTED</span>
            </div>
            <select class="project-select">
                <option>relay-app</option>
                <option>phoenix-api</option>
                <option>nova-frontend</option>
            </select>
            <button class="icon-btn" title="File Browser">&#128193;</button>
            <button class="icon-btn" title="Git Operations">&#9095;</button>
            <button class="icon-btn" title="Display Settings">&#9643;</button>
            <button class="icon-btn" title="Voice Settings">&#9881;</button>
        </div>
    </header>

    <!-- Ack Banner -->
    <div class="ack-banner">
        <div class="ack-dot"></div>
        <span>Processing: Implementing authentication middleware...</span>
    </div>

    <!-- Message Queue -->
    <div class="queue-panel">
        <span class="queue-title">Queue (2)</span>
        <div class="queue-items">
            <div class="queue-chip active">
                <span class="queue-num">1</span>
                Add rate limiting to API endpoints
            </div>
            <div class="queue-chip">
                <span class="queue-num">2</span>
                Write unit tests for auth module
            </div>
        </div>
        <button class="queue-clear">Clear All</button>
    </div>

    <!-- Main Three-Panel Layout -->
    <main class="main">

        <!-- History Sidebar (Left) -->
        <div class="panel history-sidebar">
            <div class="corner-accent tl"></div>
            <div class="corner-accent tr"></div>
            <div class="corner-accent bl"></div>
            <div class="corner-accent br"></div>
            <div class="panel-header">
                <div class="panel-title">History</div>
                <div class="panel-controls">
                    <button class="icon-btn" title="Collapse" style="width:28px;height:28px;font-size:12px;">&lsaquo;</button>
                </div>
            </div>
            <div class="history-list">
                <div class="history-item active">
                    <div class="history-time">Today 14:32</div>
                    <div class="history-preview">Implement JWT auth middleware</div>
                </div>
                <div class="history-item">
                    <div class="history-time">Today 13:15</div>
                    <div class="history-preview">Refactor database connection pool</div>
                </div>
                <div class="history-item">
                    <div class="history-time">Today 11:47</div>
                    <div class="history-preview">Add WebSocket event handlers</div>
                </div>
                <div class="history-item">
                    <div class="history-time">Today 10:22</div>
                    <div class="history-preview">Fix CORS configuration for prod</div>
                </div>
                <div class="history-item">
                    <div class="history-time">Yesterday 16:50</div>
                    <div class="history-preview">Create user settings API endpoint</div>
                </div>
                <div class="history-item">
                    <div class="history-time">Yesterday 14:08</div>
                    <div class="history-preview">Setup Redis caching layer</div>
                </div>
                <div class="history-item">
                    <div class="history-time">Yesterday 11:30</div>
                    <div class="history-preview">Migrate DB schema v2.3</div>
                </div>
                <div class="history-item">
                    <div class="history-time">Feb 2 09:15</div>
                    <div class="history-preview">Initialize project structure</div>
                </div>
            </div>
            <div class="history-count">8 CONVERSATIONS</div>
        </div>

        <!-- AXION Panel (Center) -->
        <div class="panel axion-panel">
            <div class="corner-accent tl"></div>
            <div class="corner-accent tr"></div>
            <div class="corner-accent bl"></div>
            <div class="corner-accent br"></div>
            <div class="panel-header">
                <div class="panel-title">
                    <span>AXION</span>
                </div>
                <div class="panel-controls">
                    <button class="icon-btn danger" title="Pause" style="width:28px;height:28px;font-size:11px;">&#9646;&#9646;</button>
                    <button class="icon-btn" title="Auto-read" style="width:28px;height:28px;font-size:13px;">&#128264;</button>
                    <button class="icon-btn" title="Read aloud" style="width:28px;height:28px;font-size:13px;">&#128266;</button>
                    <button class="icon-btn" title="Screenshots" style="width:28px;height:28px;font-size:13px;">&#128444;</button>
                    <button class="icon-btn" title="Clear" style="width:28px;height:28px;font-size:13px;">&#128465;</button>
                </div>
            </div>
            <div class="panel-content">
                <!-- LIVE Activity Box -->
                <div class="live-box">
                    <div class="live-scan"></div>
                    <div class="live-box-inner">
                        <div class="live-header">
                            <div class="live-indicator">
                                <div class="live-dot"></div>
                                <span class="live-label">LIVE</span>
                            </div>
                            <span class="live-status">Streaming response...</span>
                        </div>
                        <div class="live-content">
                            I've added the JWT verification middleware to <code>server.py</code>. The middleware now intercepts all requests to protected routes, validates the token signature, checks expiration, and attaches the decoded user payload to <code>request.state.user</code>.
                        </div>
                        <div class="voice-visualizer">
                            <div class="v-bar"></div>
                            <div class="v-bar"></div>
                            <div class="v-bar"></div>
                            <div class="v-bar"></div>
                            <div class="v-bar"></div>
                            <div class="v-bar"></div>
                            <div class="v-bar"></div>
                        </div>
                    </div>
                </div>

                <!-- Response Area -->
                <div class="response-area">
                    <div class="msg-entry">
                        <div class="msg-header">
                            <span class="msg-time">Today 13:15 UTC</span>
                        </div>
                        <div class="msg-user">Can you refactor the database connection pool to use async context managers and add connection health checks?</div>
                        <div class="msg-assistant">
                            <h3>Database Pool Refactor</h3>
                            <p>I've refactored the connection pool in <code>db/pool.py</code> with the following changes:</p>
                            <ul>
                                <li>Replaced synchronous connections with <code>asyncpg.create_pool()</code></li>
                                <li>Added async context manager support via <code>__aenter__</code> / <code>__aexit__</code></li>
                                <li>Implemented periodic health checks every 30 seconds</li>
                                <li>Added automatic reconnection with exponential backoff</li>
                            </ul>
<pre>class AsyncDBPool:
    def __init__(self, dsn: str, min_size=5, max_size=20):
        self.dsn = dsn
        self.min_size = min_size
        self.max_size = max_size
        self._pool = None

    async def __aenter__(self):
        self._pool = await asyncpg.create_pool(
            self.dsn,
            min_size=self.min_size,
            max_size=self.max_size
        )
        return self

    async def acquire(self):
        return await self._pool.acquire()</pre>
                            <p>The pool now gracefully handles connection drops and will auto-reconnect with a max of 5 retries using exponential backoff (1s, 2s, 4s, 8s, 16s).</p>
                        </div>
                    </div>

                    <div class="msg-entry">
                        <div class="msg-header">
                            <span class="msg-time">Today 11:47 UTC</span>
                        </div>
                        <div class="msg-user">Add WebSocket event handlers for real-time notifications. Support join/leave room events and broadcast messages.</div>
                        <div class="msg-assistant">
                            <h3>WebSocket Event System</h3>
                            <p>I've created a full WebSocket event handling system in <code>ws/handlers.py</code>. Here's the architecture:</p>
                            <ul>
                                <li>Room-based connection management with <code>ConnectionManager</code></li>
                                <li>Event types: <code>join</code>, <code>leave</code>, <code>message</code>, <code>typing</code>, <code>presence</code></li>
                                <li>Automatic cleanup on disconnect</li>
                            </ul>
<pre>@ws_router.websocket("/ws/{room_id}")
async def websocket_endpoint(ws: WebSocket, room_id: str):
    await manager.connect(ws, room_id)
    try:
        while True:
            data = await ws.receive_json()
            await manager.broadcast(room_id, data)
    except WebSocketDisconnect:
        manager.disconnect(ws, room_id)</pre>
                            <p>All active connections are tracked per room, enabling targeted broadcasts and presence indicators.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- BRETT Panel (Right) -->
        <div class="panel brett-panel">
            <div class="corner-accent tl"></div>
            <div class="corner-accent tr"></div>
            <div class="corner-accent bl"></div>
            <div class="corner-accent br"></div>
            <div class="panel-header">
                <div class="panel-title">
                    <span>BRETT</span>
                    <div style="display:inline-flex;gap:3px;margin-left:6px;">
                        <div style="width:5px;height:5px;border-radius:50%;background:var(--green);opacity:0.3;"></div>
                        <div style="width:5px;height:5px;border-radius:50%;background:var(--green);opacity:0.3;"></div>
                        <div style="width:5px;height:5px;border-radius:50%;background:var(--green);opacity:0.3;"></div>
                    </div>
                </div>
                <div class="panel-controls">
                    <button class="icon-btn" title="Copy" style="width:28px;height:28px;font-size:12px;">&#128203;</button>
                    <button class="icon-btn" title="Clear" style="width:28px;height:28px;font-size:12px;">&#128465;</button>
                    <button class="icon-btn" title="Voice" style="width:28px;height:28px;font-size:12px;">&#127908;</button>
                    <button class="icon-btn" title="Read" style="width:28px;height:28px;font-size:12px;">&#128266;</button>
                    <button class="icon-btn" title="Format" style="width:28px;height:28px;font-size:11px;">&#10024;</button>
                    <button class="icon-btn" title="Mockup" style="width:28px;height:28px;font-size:12px;">&#127912;</button>
                    <button class="icon-btn send-btn" title="Send" style="width:28px;height:28px;font-size:12px;">&#9654;</button>
                </div>
            </div>
            <div class="panel-content">
                <div class="input-wrapper">
                    <div class="line-numbers">
                        1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20
                    </div>
                    <textarea class="input-area" placeholder="Enter command sequence... (Ctrl+Enter to transmit)">Now add rate limiting middleware to all API endpoints.

Requirements:
- Use a sliding window algorithm
- 100 requests per minute per API key
- 1000 requests per minute for authenticated users
- Return 429 status with Retry-After header
- Store rate limit counters in Redis
- Add X-RateLimit-Remaining header to all responses

Also make sure the rate limiter is configurable per-route so we can set different limits for heavy endpoints like /api/search vs lightweight ones like /api/health.</textarea>
                </div>
            </div>
        </div>

    </main>

    <!-- Keyboard Shortcuts Bar -->
    <div class="shortcuts-bar">
        <span><kbd>Ctrl</kbd>+<kbd>Enter</kbd> Transmit</span>
        <span><kbd>Esc</kbd> Close</span>
        <span><kbd>Ctrl</kbd>+<kbd>/</kbd> Sidebar</span>
    </div>

</div>

</body>
</html>
