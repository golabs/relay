# Explanation of `.claude/commands/reviewtask.md`

## What This File Does

This document is an instruction manual for a command called `/reviewtask` that acts like a professional editor for task descriptions. Imagine you've jotted down some quick notes about what you need done - maybe you even just spoke your thoughts out loud and they got written down word-for-word. This command takes those rough, messy notes and transforms them into a clean, well-organized, professional task document with proper sections, clear language, and all the important details in the right places. It's like having an assistant who takes your scribbled sticky notes and turns them into a properly formatted business document. The command has two modes: a quick mode that just cleans up the writing and structure, or a thorough mode that also researches your existing code files to add helpful technical context about where and how the work connects to what you've already built.

## Key Components

**Purpose and Mode Selection**: The opening section explains that this command transforms "raw task definitions" (your rough ideas) into "professional, LLM-ready task specifications" (polished documents that AI assistants can easily understand). It offers two modes: **Quick Mode** (default) just cleans up structure and clarity like a basic proofread, while **Thorough Mode** does everything Quick Mode does plus researches your codebase to find relevant files and patterns - like hiring an editor who also does background research.

**Five-Phase Process**: This is the heart of how the command works, broken into five sequential steps:

1. **Phase 1 - Read Current Task**: Opens your existing task file (called `TASK.md`) and identifies what's already there - whether it's raw user input, voice transcriptions, existing sections, or references to specific files or features. This is like reading the rough draft before editing begins.

2. **Phase 2 - Structure Validation**: Checks that the document has all required sections in the proper format: Overview (brief summary), User Story (who wants what and why), Requirements (specific checkboxes of what needs to be done), Acceptance Criteria (how to test if it works), and Technical Notes (optional implementation tips). If any sections are missing, they get added. Think of this like ensuring a book report has all required sections: Introduction, Summary, Analysis, and Conclusion.

3. **Phase 3 - Clarity Enhancement**: This is the actual editing phase. It converts casual conversation into professional technical writing, spells out abbreviations, explains unclear terms, adds specific details where things are vague, and removes repetitive language. For example, "need to add login thing somewhere" becomes "Add authentication functionality to the homepage with session persistence."

4. **Phase 4 - Codebase Context (Thorough Mode Only)**: This advanced phase only runs if you specifically requested "thorough" mode. It launches a specialized AI research assistant (called an "Explore sub-agent") that searches through your project's code files to find related files, similar existing implementations, integration points, and relevant code patterns. It then adds this research to the document as a "Context References" section. It's like having a research assistant who goes through your filing cabinet to find all documents related to your current project and summarizes why each one matters.

5. **Phase 5 - Write Enhanced Task**: Saves the improved, polished document while carefully preserving your original intentions, any custom notes you manually added, and the status of any checklist items if you've already started working on the task. The command is very careful not to change what you meant, only how it's expressed.

**Output Format Section**: This shows a template - essentially a before-and-after example of what the cleaned-up document will look like. It demonstrates the standard structure every enhanced task should follow, with clearly labeled sections like Overview, User Story, Requirements, Acceptance Criteria, Context References (in thorough mode), Validation Approach, and Technical Notes.

**Summary Output**: After finishing all the improvements, the command displays a report of what it changed - which structural improvements it made, what clarity enhancements it applied, what context it added (if in thorough mode), and suggestions for you to review before proceeding.

**Important Notes**: A critical list of reminders that emphasizes: (1) this command does NOT automatically start implementing the task - it only cleans up the description, (2) you should review the changes before proceeding, (3) the command preserves your original meaning while improving clarity, and (4) you can choose between quick or thorough mode depending on your needs.

## How It Works

**The Basic Workflow**: When you run `/reviewtask`, the system first checks whether you typed "thorough" or left it blank (which means quick mode). It then opens your `TASK.md` file, which might contain rough notes like "add login button to homepage and make it remember user" or even a voice transcription like "umm yeah so we need to uh add authentication somewhere probably the homepage."

**The Quick Mode Transformation**: In quick mode, the command goes through three main improvements: First, it ensures all required sections exist (Overview, User Story, Requirements, Acceptance Criteria, Technical Notes). Second, it rewrites casual language into professional technical language - converting "add login thing" to "Implement user authentication functionality" and "make it remember user" to "Persist user session across page refreshes." Third, it saves this cleaned-up version while preserving any checkboxes you've already marked as complete.

**The Thorough Mode Addition**: If you specified thorough mode, everything from quick mode happens, PLUS an extra research step. The command launches a specialized AI agent that searches through your codebase looking for files related to your task. For example, if your task is about adding a login button, it might find existing authentication code, user session management files, or homepage template files. It returns a list like:
- `src/components/LoginForm.js` - Existing login component that can be reused
- `src/utils/auth.js` - Current authentication utilities to integrate with
- `pages/homepage.html` - Homepage file where new button should be added

This research gets added to your task document as helpful context, and if a file called `STACK.md` exists (which contains testing and validation commands for your project), those get added too.

**The Preservation Logic**: Throughout the entire process, the command is extremely careful to preserve three things: (1) your original intent - it never changes what you're trying to accomplish, only how clearly it's described; (2) any custom notes you manually added; (3) the checked/unchecked status of any requirement checkboxes if you've already started the task. It's like having an editor who fixes grammar and structure but never changes the meaning of your writing.

**Example Transformation**: Imagine you started with this voice transcription:
> "okay so um we need to add a login button uh somewhere on the homepage maybe and it should like save the user session or whatever so they don't have to keep logging in you know"

After `/reviewtask quick`, you'd get:

```markdown
## Overview
Implement user authentication functionality on the homepage with session persistence.

## User Story
As a website visitor
I want to log in from the homepage
So that I can access personalized features without repeated authentication

## Requirements
- [ ] Add login button to homepage
- [ ] Implement session persistence mechanism
- [ ] Prevent repeated login prompts for authenticated users

## Acceptance Criteria
- [ ] Login button is visible on homepage
- [ ] User session persists across page refreshes
- [ ] Authenticated users remain logged in until explicit logout
```

## Important Things to Know

**This is Editing, Not Implementation**: The most critical point emphasized multiple times is that this command does NOT write code or implement your task. It only cleans up and organizes the task description. Think of it like the difference between writing a clear shopping list (what reviewtask does) versus actually going to the store and buying the items (what other commands do later). The document explicitly states "Do NOT run /explain after - let user verify first" because you should review the cleaned-up task before any actual work begins.

**Two Modes for Different Needs**: Quick mode is for when you just need your notes cleaned up and made readable. Thorough mode is for when your task involves working with existing code and you'd benefit from having the system research and identify relevant files for you. Quick mode is faster; thorough mode provides more helpful context but takes longer. You choose based on whether your task is brand new work or modification of existing code.

**Voice-to-Professional Conversion**: One particularly valuable feature is converting voice transcriptions (complete with "ums," "uhs," and incomplete thoughts) into polished professional technical writing. This means you can literally think out loud about what needs to be done, and this command will transform that rambling speech into a crisp, well-structured document. This is especially useful for capturing ideas quickly without worrying about proper formatting.

**It Respects Your Work-in-Progress**: If you've already started working on a task and checked off some requirements (like marking "Add login button" as complete), the command preserves those checkmarks. It won't reset your progress - it only improves the structure, clarity, and organization while maintaining the current state of your work.

**Standardized Output Format**: Every task document that goes through this command comes out following the same template structure shown in the "Output Format" section. This consistency is valuable because it means all your task documents across different projects will have the same organization - making it easy for anyone (human or AI) to quickly find information in the expected location.

**The Thorough Mode Research**: When you use thorough mode, the command doesn't just search randomly - it looks for specific things: files related to your task's topic area, similar implementations already in your codebase that you could learn from or reuse, integration points (where your new work will connect to existing code), and relevant patterns (coding styles or approaches already used in your project). This research helps ensure your new work fits naturally with what's already built.

**Manual Review is Required**: The command explicitly stops after cleaning up your task and waits for you to review the changes before proceeding. It doesn't automatically start the next step because you might want to adjust the requirements, add additional details, or clarify something based on how the AI interpreted your rough notes. This "pause for review" is a safety feature to ensure the cleaned-up task actually matches what you intended.

**Backwards Compatible**: The document mentions "default quick mode maintains backwards compatibility," which means if you've been using this command for a while and are accustomed to how it works, it will continue working the same way unless you explicitly add "thorough" to get the new codebase research features. Existing workflows won't break.