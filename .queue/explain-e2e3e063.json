{"id": "explain-e2e3e063", "message": "Please explain this Markdown document file in simple, easy-to-understand terms for someone who may not have technical skills.\n\n**File:** docs/WALTER_Azure_MobileApp.md\n\n**Content:**\n```\n# WALTER Azure Integration \u2014 Mobile Voice App\n\n## Connecting the Mobile App to the Walter Azure Backend\n\n**Document Version:** 1.0\n**Date:** February 2026\n**Purpose:** Technical integration plan for connecting the Walter Voice mobile app (Expo/React Native) to the Walter AI backend running on Azure App Service, using Microsoft Entra ID as the identity and access control layer.\n\n---\n\n## 1. The Big Picture\n\nThe Walter Voice mobile app is a **live window into the Walter AI voice engine** that already runs on the desktop platform. The mobile app does not replicate Walter \u2014 it connects to it. Every voice conversation, every quote, every piece of data flows through the existing Walter backend on Azure.\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    MOBILE APP (Expo)                         \u2502\n\u2502                                                             \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502\n\u2502   \u2502  Login    \u2502 \u2192 \u2502  Voice   \u2502 \u2194 \u2502   Transcript +    \u2502     \u2502\n\u2502   \u2502 (Entra)  \u2502   \u2502  Mode    \u2502   \u2502   Quote Display   \u2502     \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502\n\u2502        \u2502               \u2502                   \u2502                \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502   \u2502              Auth + API + WebSocket Layer           \u2502    \u2502\n\u2502   \u2502         (JWT tokens, REST calls, voice stream)     \u2502    \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                           \u2502 HTTPS / WSS\n                           \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                AZURE (Existing Walter Backend)                \u2502\n\u2502                                                              \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502   \u2502  Express API  \u2502  \u2502  Voice Proxy  \u2502  \u2502  HAL Pricing   \u2502  \u2502\n\u2502   \u2502  (Auth, CRUD) \u2502  \u2502  (Realtime)   \u2502  \u2502  Engine        \u2502  \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502          \u2502                  \u2502                    \u2502            \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502   \u2502 PostgreSQL  \u2502   \u2502 Azure OpenAI   \u2502  \u2502  Redis     \u2502    \u2502\n\u2502   \u2502 (Users,     \u2502   \u2502 Realtime API   \u2502  \u2502  (Sessions \u2502    \u2502\n\u2502   \u2502  Quotes)    \u2502   \u2502 (Voice AI)     \u2502  \u2502   Cache)   \u2502    \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                              \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502   \u2502           Microsoft Entra ID (Identity)               \u2502  \u2502\n\u2502   \u2502     User auth, role assignment, company isolation     \u2502  \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\n**What already exists on Azure:**\n- Express/Node.js API server with full authentication\n- Azure OpenAI Realtime voice proxy (WebSocket relay)\n- HAL pricing engine integration for quote generation\n- Microsoft Entra ID SSO with MSAL\n- JWT token issuance and refresh\n- Redis session management\n- PostgreSQL for users, quotes, chat history\n- Azure Web PubSub for production-scale WebSocket connections\n\n**What the mobile app adds:**\n- A native iOS/Android interface to the existing voice pipeline\n- Microsoft Entra SSO on mobile (MSAL with PKCE public client flow)\n- Secure on-device token storage (Keychain / Keystore)\n- Microphone capture and PCM16 audio streaming\n- Quote display and insurer comparison UI\n\n---\n\n## 2. Microsoft Entra ID \u2014 The Gatekeeper\n\nEntra ID is not just login \u2014 it is the **core access control layer** that determines:\n\n1. **Can this user activate the app?** \u2014 Only users provisioned in the Entra tenant can sign in\n2. **What company do they belong to?** \u2014 Entra group/role claims map to Walter's company isolation\n3. **What role do they have?** \u2014 Broker, admin, viewer \u2014 determines what Walter shows them\n4. **Is their session still valid?** \u2014 Token expiry + server-side session check in Redis\n\n### 2.1 Mobile Auth Flow (MSAL + PKCE)\n\nThe mobile app uses the **public client** PKCE flow. No client secret touches the device.\n\n```\nStep 1: User taps \"Sign in with Microsoft\"\n        \u2193\nStep 2: MSAL library opens system browser / auth session\n        \u2192 https://login.microsoftonline.com/{tenant}/oauth2/v2.0/authorize\n        \u2192 Sends: client_id, redirect_uri, code_challenge (PKCE), scopes\n        \u2193\nStep 3: User authenticates in Microsoft's UI (may use MFA, biometrics, etc.)\n        \u2193\nStep 4: Microsoft redirects back to app\n        \u2192 msauth.com.walter.voice://auth?code=AUTHORIZATION_CODE\n        \u2193\nStep 5: App sends auth code to Walter backend\n        \u2192 POST /api/auth/microsoft/mobile\n        \u2192 Body: { code, code_verifier, redirect_uri }\n        \u2193\nStep 6: Backend exchanges code for tokens with Microsoft (using CLIENT_SECRET)\n        \u2192 Backend receives: id_token, access_token from Microsoft\n        \u2192 Backend provisions/updates user in PostgreSQL\n        \u2192 Backend creates Walter JWT (access + refresh)\n        \u2193\nStep 7: Backend returns Walter tokens + user profile to mobile app\n        \u2192 { accessToken, refreshToken, user: { id, email, firstName, role, companyId } }\n        \u2193\nStep 8: App stores tokens in secure storage\n        \u2192 iOS: Keychain (hardware-encrypted)\n        \u2192 Android: Keystore (hardware-backed encryption)\n```\n\n**Critical security point:** The mobile app never sees the Microsoft `client_secret`, the `id_token`, or any Azure API keys. It receives only Walter-issued JWTs that the backend controls.\n\n### 2.2 Entra Configuration Required\n\nThe existing Azure AD App Registration needs these additions for mobile support:\n\n**In Azure Portal \u2192 App Registration \u2192 Authentication:**\n\n| Setting | Value |\n|---------|-------|\n| Platform | Mobile and desktop applications |\n| Redirect URI | `msauth.com.walter.voice://auth` |\n| Allow public client flows | **Yes** (required for PKCE on mobile) |\n\n**API Permissions (should already exist from desktop):**\n\n| Permission | Type | Purpose |\n|------------|------|---------|\n| `openid` | Delegated | Sign-in |\n| `profile` | Delegated | Read name, role |\n| `email` | Delegated | Read email address |\n| `User.Read` | Delegated | Read full user profile |\n\n**Optional Claims (recommended):**\n- Add `email` to ID token optional claims\n- Add `preferred_username` to ID token optional claims\n\n### 2.3 Role-Based Access via Entra\n\nEntra ID roles map directly to what data Walter exposes through voice:\n\n| Entra Role | Walter Access | Voice Behaviour |\n|------------|--------------|-----------------|\n| `Broker` | Own client portfolio, quotes, policies | Full quote generation and comparison |\n| `Admin` | Company-wide data, user management | Same as broker + admin functions |\n| `Viewer` | Read-only access to assigned quotes | Can ask Walter questions but cannot generate new quotes |\n\nThe Walter backend enforces this through **company isolation middleware** \u2014 every API request and WebSocket session is scoped to the authenticated user's `companyId`. A broker at Company A cannot access Company B's data, even if they manipulate requests.\n\n---\n\n## 3. Voice Pipeline \u2014 How Audio Flows\n\nThe mobile app captures microphone audio, encodes it as PCM16, and streams it over WebSocket to the Walter backend. The backend relays it to Azure OpenAI's Realtime API, which processes speech and returns both audio responses and structured data (like quotes).\n\n### 3.1 Connection Sequence\n\n```\nMobile App                    Walter Backend (Azure)         Azure OpenAI\n    \u2502                               \u2502                           \u2502\n    \u2502  1. POST /api/voice/negotiate \u2502                           \u2502\n    \u2502  Authorization: Bearer {JWT}  \u2502                           \u2502\n    \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502                           \u2502\n    \u2502                               \u2502                           \u2502\n    \u2502                               \u2502  Validate JWT             \u2502\n    \u2502                               \u2502  Check user is active     \u2502\n    \u2502                               \u2502  Check no existing session\u2502\n    \u2502                               \u2502  Create Web PubSub token  \u2502\n    \u2502                               \u2502                           \u2502\n    \u2502  2. { url, token, sessionId } \u2502                           \u2502\n    \u2502<\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                           \u2502\n    \u2502                               \u2502                           \u2502\n    \u2502  3. Connect WSS to provided URL                           \u2502\n    \u2502\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550>\u2502                           \u2502\n    \u2502                               \u2502  4. Connect to Azure      \u2502\n    \u2502                               \u2502  OpenAI Realtime          \u2502\n    \u2502                               \u2502\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550>\u2502\n    \u2502                               \u2502                           \u2502\n    \u2502  5. Stream PCM16 audio \u2500\u2500\u2500\u2500\u2500\u2500>\u2502  6. Forward audio \u2500\u2500\u2500\u2500\u2500\u2500>\u2502\n    \u2502                               \u2502                           \u2502\n    \u2502                               \u2502  7. AI processes speech   \u2502\n    \u2502                               \u2502  Runs function_calls      \u2502\n    \u2502                               \u2502  (e.g., get_quote \u2192 HAL)  \u2502\n    \u2502                               \u2502                           \u2502\n    \u2502  8. Receive AI audio <\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502  <\u2500\u2500\u2500\u2500 AI response audio  \u2502\n    \u2502  9. Receive transcript <\u2500\u2500\u2500\u2500\u2500\u2500\u2502  <\u2500\u2500\u2500\u2500 Transcript text    \u2502\n    \u2502  10. Receive quote data <\u2500\u2500\u2500\u2500\u2500\u2502  <\u2500\u2500\u2500\u2500 function_call result\u2502\n    \u2502                               \u2502                           \u2502\n    \u2502  11. Display quote card       \u2502                           \u2502\n    \u2502  12. Play audio through speaker                           \u2502\n```\n\n### 3.2 Audio Specification\n\n| Parameter | Value | Notes |\n|-----------|-------|-------|\n| Format | PCM16 (16-bit signed integer) | Raw uncompressed audio |\n| Sample rate | 24,000 Hz | Azure OpenAI Realtime requirement |\n| Channels | 1 (mono) | Single channel |\n| Bit depth | 16-bit | 2 bytes per sample |\n| Data rate | ~48 KB/s | 5-minute call \u2248 14 MB |\n| Frame size | 4,800 samples (200ms) | Recommended chunk size for streaming |\n\n### 3.3 WebSocket Message Protocol\n\nMessages between the mobile app and Walter backend follow this format:\n\n**Client \u2192 Server (audio data):**\n```json\n{\n  \"type\": \"audio\",\n  \"data\": \"<base64-encoded PCM16 chunk>\"\n}\n```\n\n**Client \u2192 Server (control):**\n```json\n{ \"type\": \"session.start\" }\n{ \"type\": \"session.end\" }\n{ \"type\": \"input.mute\", \"muted\": true }\n```\n\n**Server \u2192 Client (audio response):**\n```json\n{\n  \"type\": \"audio\",\n  \"data\": \"<base64-encoded PCM16 response>\"\n}\n```\n\n**Server \u2192 Client (transcript):**\n```json\n{\n  \"type\": \"transcript\",\n  \"sender\": \"user\" | \"ai\",\n  \"text\": \"I need home insurance for my property in Sydney\",\n  \"timestamp\": \"2026-02-13T14:34:00Z\",\n  \"isFinal\": true\n}\n```\n\n**Server \u2192 Client (quote / function call result):**\n```json\n{\n  \"type\": \"function_call_result\",\n  \"function\": \"get_quote\",\n  \"data\": {\n    \"quoteId\": \"WLT-2024-HI-0847\",\n    \"insurers\": [\n      { \"name\": \"Allianz\", \"annualPremium\": 2847 },\n      { \"name\": \"QBE\", \"annualPremium\": 3120 },\n      { \"name\": \"Zurich\", \"annualPremium\": 2950 }\n    ],\n    \"propertyDetails\": {\n      \"address\": \"42 Harbour View Dr, Sydney NSW 2000\",\n      \"type\": \"Residential - House\",\n      \"sumInsured\": 1250000,\n      \"excess\": 500\n    }\n  }\n}\n```\n\n**Server \u2192 Client (session events):**\n```json\n{ \"type\": \"session.ready\" }\n{ \"type\": \"session.expired\", \"reason\": \"timeout\" }\n{ \"type\": \"error\", \"code\": \"AUTH_EXPIRED\", \"message\": \"Token expired\" }\n```\n\n### 3.4 Development vs Production WebSocket\n\n| Mode | Connection Target | When to Use |\n|------|------------------|-------------|\n| **Development** | `wss://{BACKEND}/api/voice/ws?token={JWT}` | Local dev, testing |\n| **Production** | Azure Web PubSub URL (returned by `/negotiate`) | Live deployments |\n\nIn production, Azure Web PubSub acts as a scalable message broker between the mobile app and the Walter backend. The app never connects directly to the backend's WebSocket \u2014 instead, Web PubSub handles connection management, reconnection, and geographic distribution.\n\n---\n\n## 4. What the Mobile App Needs to Build\n\n### 4.1 Service Layer Architecture\n\nThe mobile app needs four core services to connect to the Azure backend:\n\n```\nwalter-voice-app/\n\u2514\u2500\u2500 src/\n    \u251c\u2500\u2500 config/\n    \u2502   \u2514\u2500\u2500 environment.ts          \u2190 Public configuration (backend URL, MSAL client ID)\n    \u251c\u2500\u2500 services/\n    \u2502   \u251c\u2500\u2500 auth/\n    \u2502   \u2502   \u251c\u2500\u2500 AuthService.ts      \u2190 MSAL login, token management, secure storage\n    \u2502   \u2502   \u2514\u2500\u2500 TokenManager.ts     \u2190 JWT storage, refresh logic, auto-retry\n    \u2502   \u251c\u2500\u2500 api/\n    \u2502   \u2502   \u2514\u2500\u2500 WalterAPIClient.ts  \u2190 Authenticated REST client with token refresh\n    \u2502   \u251c\u2500\u2500 voice/\n    \u2502   \u2502   \u251c\u2500\u2500 VoiceService.ts     \u2190 WebSocket connection, session lifecycle\n    \u2502   \u2502   \u251c\u2500\u2500 AudioCapture.ts     \u2190 Microphone \u2192 PCM16 encoding\n    \u2502   \u2502   \u2514\u2500\u2500 AudioPlayback.ts    \u2190 PCM16 decoding \u2192 speaker output\n    \u2502   \u2514\u2500\u2500 quotes/\n    \u2502       \u2514\u2500\u2500 QuoteService.ts     \u2190 Quote data handling from voice function calls\n    \u251c\u2500\u2500 context/\n    \u2502   \u251c\u2500\u2500 AuthContext.tsx          \u2190 React context for auth state\n    \u2502   \u2514\u2500\u2500 VoiceContext.tsx         \u2190 React context for voice session state\n    \u2514\u2500\u2500 constants/\n        \u2514\u2500\u2500 theme.ts                \u2190 Already exists\n```\n\n### 4.2 Environment Configuration\n\n```typescript\n// src/config/environment.ts\n// ALL values here are PUBLIC \u2014 no secrets\n\nconst ENV = {\n  development: {\n    API_BASE_URL: 'https://walter-dev.azurewebsites.net',\n    WS_BASE_URL: 'wss://walter-dev.azurewebsites.net',\n    VOICE_MODE: 'direct' as const,  // Direct WebSocket in dev\n  },\n  production: {\n    API_BASE_URL: 'https://walter-api.yourcompany.com',\n    WS_BASE_URL: 'wss://walter-api.yourcompany.com',\n    VOICE_MODE: 'pubsub' as const,  // Azure Web PubSub in prod\n  },\n};\n\nexport const config = {\n  ...(__DEV__ ? ENV.development : ENV.production),\n\n  // Microsoft Entra ID \u2014 public client values (NOT secrets)\n  MSAL_CLIENT_ID: 'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx',\n  MSAL_AUTHORITY: 'https://login.microsoftonline.com/YOUR_TENANT_ID',\n  MSAL_REDIRECT_URI: 'msauth.com.walter.voice://auth',\n  MSAL_SCOPES: ['openid', 'profile', 'email', 'User.Read'],\n\n  // Audio\n  VOICE_SAMPLE_RATE: 24000,\n  VOICE_CHANNELS: 1,\n  VOICE_FRAME_SIZE: 4800,  // 200ms at 24kHz\n\n  // Session\n  SESSION_TIMEOUT_MS: 1800000,  // 30 minutes\n  TOKEN_REFRESH_BUFFER_MS: 300000,  // Refresh 5 min before expiry\n\n  // App\n  APP_VERSION: '1.0.0',\n};\n```\n\n### 4.3 Auth Service (MSAL Integration)\n\n```typescript\n// src/services/auth/AuthService.ts \u2014 Conceptual structure\n\nimport * as AuthSession from 'expo-auth-session';\nimport * as SecureStore from 'expo-secure-store';\nimport { config } from '../../config/environment';\n\nexport class AuthService {\n  // Initiate Microsoft Entra login via system browser\n  async login(): Promise<AuthResult>\n\n  // Exchange auth code with Walter backend\n  private async exchangeCodeForTokens(code: string, codeVerifier: string): Promise<TokenPair>\n\n  // Store tokens in iOS Keychain / Android Keystore\n  private async storeTokens(\n```\n\nPlease provide:\n1. **What This File Does** - A simple one-paragraph summary\n2. **Key Components** - Break down the main parts/sections in plain language\n3. **How It Works** - Explain the flow or logic simply\n4. **Important Things to Know** - Any key details a non-technical person should understand\n\nUse simple analogies where helpful. Avoid jargon or explain technical terms when you must use them.\n\nIMPORTANT: Respond ONLY with the explanation. Do not use any tools, do not read any files, do not make any changes. Just explain the content provided above.", "model": "sonnet", "project": "explain-walter_mobile_app", "status": "completed", "images": [], "files": [], "created": 1771056255.2930512, "job_type": "explain", "activity": "Thinking...", "started_at": 1771056352.3400946}